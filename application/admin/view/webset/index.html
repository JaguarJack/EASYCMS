<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>网站信息设置</title>
  <link rel="stylesheet" href="/public/static/css/amazeui.min.css"/>
  <link rel="stylesheet" href="/public/static/css/bootstrap.min.css"/>
  <script src="/public/static/js/jquery.min.js"></script>
  <script src="/public/static/js/bootstrap.min.js"></script>
  <script src="/public/static/js/ajaxfileupload.js"></script>
  <script src="/public/static/layer/layer.js"></script>
</head>
<style>
	.tab-content{margin-top:10px;}
	.form-horizontal{margin:auto;width:1100px;}
	.btn-block{width:40%;font-size:20px;}
</style>
<body>
<div class="admin-content">

    <div class="am-cf am-padding">
      <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">基本管理</strong>/<small>网站配置</small></div>
    </div>
	<ul id="myTab" class="nav nav-tabs">
	   <li class="active"><a href="#info" data-toggle="tab">基本信息</a></li>
	   <li><a href="#link" data-toggle="tab">联系方式</a></li>
	   <li><a href="#seo" data-toggle="tab">seo设置</a></li>
	</ul>
	<!-- 基本信息 -->
	<div id="myTabContent" class="tab-content">
	   <div class="tab-pane fade in active" id="info">
	   <div class="tab-content"><div class="alert alert-success">在这里，您可以设置网站的基本信息</div></div>
	     <form class="form-horizontal" role="form">
		   <div class="form-group">
		      <label for="firstname" class="col-sm-2 control-label">站点名称</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="site_name" placeholder="请输入站点名称" value="{:get_base_config_info('site_name')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">站点网址</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="site_link" placeholder="请输入站点网址" value="{:get_base_config_info('site_link')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">站点LOGO</label>
		      <div class="am-form-group am-form-file">
				  <button type="button" class="am-btn am-btn-danger am-btn-sm" style="margin-left:17px;" id="file">
				    <i class="am-icon-cloud-upload"></i> 请上传logo图片</button>
				    <img src="{:get_base_config_info('logo')}" style="width:100px;" class="img">
				    <input id="doc-form-file" name="doc-form-file" type="file" multiple style="display:none;">
			  </div>
			  
		   </div>
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">备案信息</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="record" placeholder="请输入备案信息" value="{:get_base_config_info('record')}">
		      </div>
		   </div>
		    <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label" placeholder="输入统计代码,cnzz或是百度站长">统计代码</label>
		      <div class="col-sm-6">
		         <textarea class="form-control" rows="3" id="site_code"><?php echo htmlspecialchars(get_base_config_info('site_code'));?></textarea>
		      </div>
		   </div>
		    <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label" placeholder="输入版权信息">版权信息</label>
		      <div class="col-sm-6">
		         <textarea class="form-control" rows="3" id="copyright">{:get_base_config_info('copyright')}</textarea>
		      </div>
		   </div>
		  	<div class="col-sm-offset-2 col-sm-10">
		        <button type="button" class="btn btn-primary btn-lg btn-block info">提交</button>
		    </div>
		</form>
	   </div>
	   
	   <!-- 联系信息 -->
	   <div class="tab-pane fade" id="link">
	   	   <div class="tab-content"><div class="alert alert-success">在这里，您可以设置联系信息</div></div>
	   	<form class="form-horizontal" role="form">
		   <div class="form-group">
		      <label for="firstname" class="col-sm-2 control-label">公司名称</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="company" placeholder="请输入站点名称" value="{:get_base_config_info('company')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">公司地址</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="addr" placeholder="请输入备案信息" value="{:get_base_config_info('addr')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">联系方式</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="phone" placeholder="请输入联系方式" value="{:get_base_config_info('phone')}">
		      </div>
		   </div>
		   
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">站长QQ</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="qq" placeholder="请输入qq号码" value="{:get_base_config_info('qq')}">
		      </div>
		   </div>
		  <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">站长邮箱</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="email" placeholder="请输入邮箱" value="{:get_base_config_info('email')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <div class="col-sm-offset-2 col-sm-10">
		        <button type="button" class="btn btn-primary btn-lg btn-block link_info"> 提交</button>
		      </div>
		   </div>
		</form>
	   </div>
	   
	   <!-- seo信息 -->
	   <div class="tab-pane fade" id="seo">
	   	   <div class="tab-content"><div class="alert alert-success">在这里，您可以设置首页的seo信息</div></div>
			<form class="form-horizontal" role="form">
			<div class="form-group">
		      <label for="firstname" class="col-sm-2 control-label">网站域名</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="siteurl" placeholder="请输入网站域名" value="{:get_base_config_info('siteurl')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <label for="firstname" class="col-sm-2 control-label">首页标题</label>
		      <div class="col-sm-6">
		         <input type="text" class="form-control" id="title" placeholder="请输入首页标题" value="{:get_base_config_info('title')}">
		      </div>
		   </div>
		   <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">首页关键词</label>
		      <div class="col-sm-6">
		         <textarea class="form-control" rows="3" id="keywords" placeholder="请输入关键词,之间用,隔开">{:get_base_config_info('keywords')}</textarea>
		      </div>
		   </div>
			 <div class="form-group">
		      <label for="lastname" class="col-sm-2 control-label">首页描述</label>
		      <div class="col-sm-6">
		         <textarea class="form-control" rows="4" id="description" placeholder="请输入首页描述">{:get_base_config_info('description')}</textarea>
		      </div>
		   </div>
		   <div class="form-group">
		      <div class="col-sm-offset-2 col-sm-10">
		        <button type="button" class="btn btn-primary btn-lg btn-block seo"> 提交</button>
		      </div>
		   </div>
		</form>
	   </div>
	</div>
</div>
</body>
</html>
<script>
	//获取文件名
	function getFileName(filepath){
		return filepath.substring(filepath.lastIndexOf("\\")+1); 
	}
	$('.am-btn').click(function(){
		$("#doc-form-file").click();
	});
	
	$('#doc-form-file').change(function(){
		if(getFileName($(this).val())){
			$('.am-btn').html('<i class="am-icon-cloud-upload"></i>&nbsp;&nbsp;'+getFileName($(this).val()));

		}else{
			$('.am-btn').html('<i class="am-icon-cloud-upload"></i>&nbsp;&nbsp;请上传logo图片');

		}
	});
	function html_encode(str)  
	{  
	    var s = "";  
	    if (str.length == 0) return false;  
	    s = str.replace(/&/g, "&amp;");  
	    s = s.replace(/</g, "&lt;");  
	    s = s.replace(/>/g, "&gt;");    
	    s = s.replace(/\"/g, "&quot;");   
	    return s;  
	}
	//提交网站信息
	$('.info').click(function(){
		var site_name = $('#site_name').val();
		var site_link = $('#site_link').val();
		var logo      = $('#doc-form-file').val();
		var record    = $('#record').val();
		var copyright = $('#copyright').val();
		var site_code = html_encode($('#site_code').val());
		$.ajaxFileUpload({
             url:'{:url("Webset/addSiteInfo")}',
             type:'POST',
             fileElementId:'doc-form-file',
             dataType: 'json',
             data: {
	            	 site_name:site_name,
	            	 site_link:site_link,
	            	 record:record,
	            	 copyright:copyright,
	            	 site_code:site_code
            	 },
             success: function (data){
            	 if(data.code == '10004'){
            		 layer.tips(data.msg, "#"+data.data.name);
            	 }else if(data.code == '10000'){
            		 layer.msg(data.msg,{
       				  	time: 1000 //2秒关闭（如果不配置，默认是3秒）
       				}, function(){
       					window.location.reload();
       				});	
            	 }else{
            		 layer.msg(data.msg);
            	 }
             }
        })
	})
	//提交公司信息
	$('.link_info').click(function(){
		var company = $('#company').val();
		var addr    = $('#addr').val();
		var link    = $('#phone').val();
		var qq      = $('#qq').val();
		var email   = $('#email').val();
		var url     = "{:url('Webset/setCompanyInfo')}";
		$.post(url,{company:company,addr:addr,phone:link,qq:qq,email:email},function(data){
			if(data.code == '10004'){
       		 	 layer.tips(data.msg, "#"+data.data.name);
	       	 }else if(data.code == '10000'){
	       		 layer.msg(data.msg);
	       	 }else{
	       		 layer.msg(data.msg);
	       	 }
		})
	})
	//提交seo信息
	$('.seo').click(function(){
		var siteurl  = $('#siteurl').val();
		var title 	 = $('#title').val();
		var keywords = $('#keywords').val();
		var description  = $('#description').val();
		var url      = "{:url('Webset/setSeoInfo')}";
		$.post(url,{siteurl:siteurl,title:title,keywords:keywords,description:description},function(data){
			if(data.code == '10004'){
       		 	 layer.tips(data.msg, "#"+data.data.name);
	       	 }else if(data.code == '10000'){
	       		 layer.msg(data.msg);
	       	 }else{
	       		 layer.msg(data.msg);
	       	 }
		})
	})
</script>